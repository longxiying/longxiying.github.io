<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="google-site-verification" content="TZE0rZyIqLl10trYu3BWBWa1Vmz6HFwhb2OcNEK4u-s" />
     <link rel="shortcut icon" href= /img/favicon.ico >
    <title>
        EMV.COOL
    </title>
    <meta name="description" content= Study!Study!Study! >
    <meta name="keywords" content= Blog,Hexo,Theme,emv,visa,googlepay,mastercard,amex >
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="EMV.COOL" type="application/atom+xml">
</head>
<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-home
 replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            Complete list of PIN-blocks
        </p>
        <hr>
    </div>
    <div class="post-content">
        <p>The most common PIN-block formats are based on ISO 9564, but many more are in implemented worldwide. Another common problem is that same PIN-block calculation methods are being called with their aliases, making sometimes difficult to get a right one. This article brings a list of PIN-blocks applied in payments, their calculation methods and examples and bit of related background.</p>
<p>Well worded Wikipedia’s definition of a PIN-block format: «The PIN is used to verify the identity of a customer (the user of a bank card) within an electronic funds transfer system, and (typically) to authorize the transfer of funds, so it is important to protect it against unauthorized disclosure or misuse. Modern banking systems require interoperability between different card issuers, acquiring banks and retailers – including transmission of PINs between those entities – so a common set of rules for handling and securing PINs is required, both to ensure technical compatibility and a mutually agreed level of security.»</p>
<table>
<thead>
<tr>
<th><strong>PIN Block Format</strong></th>
<th><strong>Alias</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ISO-0</td>
<td>Format 0, ANSI X9.8, VISA-1, and ECI-0</td>
<td>ISO 9564-1 Format 0. An ISO-0 PIN block format is equivalent to the ANSI X9.8, VISA-1, and ECI-1 PIN block formats and is similar to a VISA-4 PIN block format. The ISO-0 PIN block format supports a PIN from 4 to 12 digits in length. A PIN that is longer than 12 digits is truncated on the right. The first nibble (which identifies the block format) has the value 0.</td>
</tr>
<tr>
<td>ISO-1</td>
<td>Format 1 and ECI-4</td>
<td>ISO 9564-1:2003 Format 1. The ISO-1 PIN block format is equivalent to an ECI-4 PIN block format and is recommended for usage where no PAN data is available. The ISO-1 PIN block format supports a PIN from 4 to 12 digits in length. A PIN that is longer than 12 digits is truncated on the right. The first nibble (which identifies the block format) has the value 1.</td>
</tr>
<tr>
<td>ISO-2</td>
<td>Format 2</td>
<td>ISO 9564-3: 2003 Format 2. Format 2 is for local use with off-line systems only. The first nibble (which identifies the block format) has the value 2.</td>
</tr>
<tr>
<td>ISO-3</td>
<td>Format 3</td>
<td>ISO 9564-1: 2002 Format 3. Format 3 is the same as format 0, except that the “fill” digits are random values from 10 to 15, and the first nibble (which identifies the block format) has the value 3.</td>
</tr>
<tr>
<td>ANSI X9.8</td>
<td>–</td>
<td>Same as ISO 9564 Format 0 (ISO-0)</td>
</tr>
<tr>
<td>OEM-1</td>
<td>Diebold, Docutel, NCR</td>
<td>The OEM-1 PIN block format is equivalent to the PIN block formats that Diebold, Docutel, and NCR define. The OEM-1 PIN block format supports a PIN from 4 to 12 digits in length. A PIN that is longer than 12 digits is truncated on the right. Identical to existing Docutel 5100 Format 8</td>
</tr>
<tr>
<td>ECI-1</td>
<td>–</td>
<td>Eurocheque International format 1. Same as ISO 9564 Format 0 (ISO-0)</td>
</tr>
<tr>
<td>ECI-2</td>
<td>–</td>
<td>Eurocheque International format 2. The ECI-2 PIN block format supports a 4-digit PIN. A PIN that is longer than 4 digits is truncated on the right.</td>
</tr>
<tr>
<td>ECI-3</td>
<td>–</td>
<td>Eurocheque International format 3. The ECI-3 PIN block format supports a PIN from 4 to 6 digits in length. A PIN that is longer than 6 digits is truncated on the right.</td>
</tr>
<tr>
<td>ECI-4</td>
<td>–</td>
<td>Eurocheque International format 4. Same as ISO 9564 Format 1 (ISO-1)</td>
</tr>
<tr>
<td>IBM 3621</td>
<td></td>
<td>The 3621 PIN block format supports a PIN from 1 to 12 digits in length. A PIN that is longer than 12 digits is truncated on the right.</td>
</tr>
<tr>
<td>IBM 3624</td>
<td>PIN-TRAN 4</td>
<td>The 3624 PIN block format is equivalent to the PIN-TRAN 4 format and supports a PIN from 1 to 16 digits in length. A PIN that is longer than 16 digits is truncated on the right.</td>
</tr>
<tr>
<td>IBM 4704-EPP (Encrypting PIN Pad)</td>
<td>–</td>
<td>The 4704 encrypting PIN Pad PIN block format supports a PIN from 1 to 13 digits in length. A PIN that is longer than 13 digits is truncated on the right.</td>
</tr>
<tr>
<td>IBM 5906</td>
<td></td>
<td>Same as IBM 3621.</td>
</tr>
<tr>
<td>VISA-1</td>
<td>–</td>
<td>Same as ISO 9564 Format 0 (ISO-0)</td>
</tr>
<tr>
<td>VISA-2</td>
<td>Docutel 2</td>
<td>The VISA-2 PIN block format supports a PIN from 4 to 6 digits in length. A PIN that is longer than 6 digits is truncated on the right.</td>
</tr>
<tr>
<td>VISA-3</td>
<td>–</td>
<td>The VISA-3 PIN block format supports a PIN from 4 to 12 digits in length. A PIN that is longer than 12 digits is truncated on the right.</td>
</tr>
<tr>
<td>VISA-4</td>
<td>–</td>
<td>The VISA-4 PIN block format supports a PIN from 4 to 12 digits in length. A PIN that is longer than 12 digits is truncated on the right.</td>
</tr>
<tr>
<td>Docutel 2</td>
<td>VISA-2</td>
<td>Same as VISA-2. Contains 1-digit PIN length, 4 to 6-digit PIN and a user-defined padding string of 9 digits. If the PIN has 4 or 5 digits, it is initially padded to the right with 2 or 1 zero digits to total 6 digits.</td>
</tr>
<tr>
<td>AS2805 Format 1</td>
<td>–</td>
<td>The AS2805 Format 1 PIN block is used in situations where the account number is not available. The PIN block is formed by concatenation of the PIN and other data. PIN block format supports a PIN from 4 to 12 digits in length.</td>
</tr>
<tr>
<td>AS2805 Format 8</td>
<td>Format 46</td>
<td>The zero length PIN block format is identical to format 01 with the some exceptions.</td>
</tr>
<tr>
<td>ISO-4</td>
<td>Format 4</td>
<td>ISO 9564-1: 2017 Format 4. Format 4 uses AES encryption. PIN Block is padded with fill digit ‘A’ and also with random random values from 0 to 15, and the first nibble (which identifies the block format) has the value 4.</td>
</tr>
</tbody></table>
<p>##ISO-0 (FORMAT 0)</p>
<p>Is the first and most common PIN block encoding format based on ISO 9564 – an international standard for personal identification number (PIN) management and security in retail banking.</p>
<p>####CALCULATION STEPS:</p>
<p>#####1. Prepare a PIN – L is length of the PIN, P is PIN digit, F is padding value “F”</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>L</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
</tr>
</tbody></table>
<p>#####2. Prepare PAN – take 12 rightmost digits of the primary account number (excluding the check digit)</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
</tr>
</tbody></table>
<p>#####3. XOR both values</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>L</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
</tr>
<tr>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
</tr>
</tbody></table>
<p>####EXAMPLE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block encrypt operation finished  </span><br><span class="line"></span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PIN: 1234  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: Format 0 (ISO-0)  </span><br><span class="line"> </span><br><span class="line">Clear PIN block:0412AC89ABCDEF67</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block decode operation finished  </span><br><span class="line"></span><br><span class="line">PIN block: 0412AC89ABCDEF67  </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: Format 0 (ISO-0)  </span><br><span class="line"></span><br><span class="line">Decoded PIN: 1234</span><br></pre></td></tr></table></figure>
<p>##ISO-1 (FORMAT 1)</p>
<p>The ISO-1 PIN block format is equivalent to an ECI-4 PIN block format. The ISO-1 PIN block format supports a PIN from 4 to 12 digits in length. A PIN that is longer than 12 digits is truncated on the right.</p>
<p>####CALCULATION STEPS:</p>
<p>#####1. Prepare a PIN – L is length of the PIN, P is PIN digit, R is random value</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>L</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
</tr>
</tbody></table>
<p>Where:</p>
<ul>
<li><p>  L – is the length of the PIN, which is a 4-bit value from X’4′ to X’C’.</p>
</li>
<li><p>  R – is a random digit, which is a value from X’0′ to X’F’. Typically, this should be used for predetermined transaction unique data such as a sequence number.</p>
</li>
</ul>
<p>####EXAMPLE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block encrypt operation finished  </span><br><span class="line">   </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PIN: 1234  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: Format 1 (ISO-1)  </span><br><span class="line"></span><br><span class="line">Clear PIN block:141234CE8C767872</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block decode operation finished  </span><br><span class="line">  </span><br><span class="line">PIN block: 141234CE8C767872  </span><br><span class="line">PAN: N&#x2F;A  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: Format 1 (ISO-1)  </span><br><span class="line"> </span><br><span class="line">Decoded PIN: 1234</span><br></pre></td></tr></table></figure>
<p>##ISO-2 (FORMAT 2)</p>
<p>Format 2 is for local use with off-line systems only (e.g. smart cards).</p>
<p>####CALCULATION STEPS:</p>
<p>#####1. Prepare a PIN – L is length of the PIN, P is PIN digit, F is padding value ‘F’</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>2</td>
<td>L</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
</tr>
</tbody></table>
<p>Where:</p>
<ul>
<li><p>  L – is the length of the PIN, which is a 4-bit value from X’4′ to X’C’.</p>
</li>
<li><p>  F – is a padding character, which is a value of X’F’.</p>
</li>
</ul>
<p>####EXAMPLE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block encrypt operation finished  </span><br><span class="line">  </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PIN: 1234  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: Format 2 (ISO-2)  </span><br><span class="line"></span><br><span class="line">Clear PIN block:241234FFFFFFFFFF</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block decode operation finished  </span><br><span class="line">  </span><br><span class="line">PIN block: 241234FFFFFFFFFF  </span><br><span class="line">PAN: N&#x2F;A  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: Format 2 (ISO-2)  </span><br><span class="line"></span><br><span class="line">Decoded PIN: 1234</span><br></pre></td></tr></table></figure>
<p>##ISO-3 (FORMAT 3)</p>
<p>Format 3 is the same as format 0, except that the “fill” digits are random values from 10 to 15, and the first nibble (which identifies the block format) has the value 3.</p>
<p>####CALCULATION STEPS:</p>
<ol>
<li> Prepare a PIN – L is length of the PIN, P is PIN digit, R is random value from X’0′ to X’F’</li>
</ol>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>3</td>
<td>L</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
</tr>
</tbody></table>
<ol>
<li> Prepare PAN – take 12 rightmost digits of the primary account number (excluding the check digit)</li>
</ol>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
</tr>
</tbody></table>
<ol>
<li> XOR both values</li>
</ol>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>L</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
</tr>
<tr>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
</tr>
</tbody></table>
<p>####EXAMPLE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block encrypt operation finished  </span><br><span class="line">  </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PIN: 1234  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: Format 3 (ISO-3)  </span><br><span class="line"></span><br><span class="line">Clear PIN block:3412ACC9B98CDF43</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block decode operation finished  </span><br><span class="line">  </span><br><span class="line">PIN block: 3412ACC9B98CDF43  </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: Format 3 (ISO-3)  </span><br><span class="line"></span><br><span class="line">Decoded PIN: 1234</span><br></pre></td></tr></table></figure>
<p>##ISO-4 (FORMAT 4)</p>
<p>ISO 9564-1: 2017 Format 4. Format 4 uses AES-128 ECB encryption. PIN Block is padded with fill digit ‘A’ and also with random random values from 0 to 15, and the first nibble (which identifies the block format) has the value 4.</p>
<p>####CALCULATION STEPS:</p>
<p>#####1.  Prepare a PIN – L is length of the PIN, P is PIN digit, F is fill digit ‘A’. R is random value from X’0′ to X’F’</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
<th><strong>17</strong></th>
<th><strong>18</strong></th>
<th><strong>19</strong></th>
<th><strong>20</strong></th>
<th><strong>21</strong></th>
<th><strong>22</strong></th>
<th><strong>23</strong></th>
<th><strong>24</strong></th>
<th><strong>25</strong></th>
<th><strong>26</strong></th>
<th><strong>27</strong></th>
<th><strong>28</strong></th>
<th><strong>29</strong></th>
<th><strong>30</strong></th>
<th><strong>31</strong></th>
<th><strong>32</strong></th>
</tr>
</thead>
<tbody><tr>
<td>4</td>
<td>L</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>F</td>
<td>F</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
</tr>
</tbody></table>
<p>#####2.  Prepare PAN – take the primary account number – M is PAN length indicating PAN length of 12 plus the value of the field ‘0’-‘7’ (ranging then from 12 to 19). If the PAN is less than 12 digits, the digits are right justified and padded to the left with zeros and M is set to ‘0’. A is PAN digit, 0 is PAD digit ‘0’</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
<th><strong>17</strong></th>
<th><strong>18</strong></th>
<th><strong>19</strong></th>
<th><strong>20</strong></th>
<th><strong>21</strong></th>
<th><strong>22</strong></th>
<th><strong>23</strong></th>
<th><strong>24</strong></th>
<th><strong>25</strong></th>
<th><strong>26</strong></th>
<th><strong>27</strong></th>
<th><strong>28</strong></th>
<th><strong>29</strong></th>
<th><strong>30</strong></th>
<th><strong>31</strong></th>
<th><strong>32</strong></th>
</tr>
</thead>
<tbody><tr>
<td>M</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A/0</td>
<td>A/0</td>
<td>A/0</td>
<td>A/0</td>
<td>A/0</td>
<td>A/0</td>
<td>A/0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody></table>
<p>#####2.  PIN block is encrypted with AES key</p>
<p>#####3.  The resulting Intermediate Block A is then XOR’ed with PAN Block</p>
<p>#####4.  The resulting Intermediate Block B is enciphered with the AES key again so we get the Enciphered PIN Block</p>
<p>####EXAMPLE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block encrypt operation finished  </span><br><span class="line">  </span><br><span class="line">PAN: 432198765432109870  </span><br><span class="line">PIN: 1234  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: Format 4 (ISO-4)  </span><br><span class="line"></span><br><span class="line">Clear PIN block:441234AAAAAAAAAA911B9B36BC7CE94E  </span><br><span class="line">Clear PAN block:64321987654321098700000000000000</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block decode operation finished  </span><br><span class="line">  </span><br><span class="line">PIN block: 441234AAAAAAAAAA911B9B36BC7CE94E  </span><br><span class="line">PAN block: 64321987654321098700000000000000  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: Format 4 (ISO-4)  </span><br><span class="line"></span><br><span class="line">Decoded PIN: 1234  </span><br><span class="line">Decoded PAN: 432198765432109870</span><br></pre></td></tr></table></figure>
<p>##ANSI X9.8</p>
<p>Same as ISO-0.</p>
<p>###OEM-1 / DIEBOLD / DOCUTEL / NCR</p>
<p>The OEM-1 PIN block format is equivalent to the PIN block formats that Diebold, Docutel, and NCR define. The OEM-1 PIN block format supports a PIN from 4 to 12 digits in length. A PIN that is longer than 12 digits is truncated on the right.</p>
<p>####CALCULATION STEPS:</p>
<p>#####1.  Prepare a PIN – P is PIN digit, X is pad value, which is a 4-bit value from<br>    X’0′ to X’F’</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
</tr>
</tbody></table>
<p>Where:</p>
<ul>
<li><p>P – is a PIN digit, which is a 4-bit value from X’0′ to X’9′. The values of<br>  the PIN digits are independent.</p>
</li>
<li><p>X – is a pad value has a 4-bit value from X’0′ to X’F’ and must be different<br>  from any PIN digit. The number of pad values for this format is in the range<br>  from 4 to 12, and all the pad values must have the same value.</p>
</li>
</ul>
<p>####EXAMPLE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block encrypt operation finished  </span><br><span class="line"> </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PIN: 1234  </span><br><span class="line">PAD: 5  </span><br><span class="line">Format: Diebold, Docutel, NCR  </span><br><span class="line">  </span><br><span class="line">Clear PIN block:1234555555555555</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block decode operation finished  </span><br><span class="line">  </span><br><span class="line">PIN block: 1234555555555555  </span><br><span class="line">PAN: N&#x2F;A  </span><br><span class="line">PAD: 5  </span><br><span class="line">Format: Diebold, Docutel, NCR  </span><br><span class="line">  </span><br><span class="line">Decoded PIN: 1234</span><br></pre></td></tr></table></figure>
<p>##ECI-1 </p>
<p>Same as ISO-0.</p>
<p>##ECI-2</p>
<p>The ECI-2 PIN block format supports a 4-digit PIN. A PIN that is longer than 4 digits is truncated on the right.</p>
<p>####CALCULATION STEPS:</p>
<p>#####1.  Prepare a PIN – P is PIN digit, R is random value</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
</tr>
</tbody></table>
<p>Where:</p>
<ul>
<li><p>P – is a PIN digit, which is a 4-bit value from X’0′ to X’9′. The PIN length<br>  for this format is always 4.The values of the PIN digits are independent.</p>
</li>
<li><p>R is a random pad value, which is a value from X’0′ to X’F’. This format<br>  contains 12 random pad values that can have different values.</p>
</li>
</ul>
<p>####EXAMPLE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block encrypt operation finished  </span><br><span class="line">  </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PIN: 1234  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: ECI-2  </span><br><span class="line"></span><br><span class="line">Clear PIN block:1234095621C2F02F</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block decode operation finished  </span><br><span class="line">  </span><br><span class="line">PIN block: 1234095621C2F02F  </span><br><span class="line">PAN: N&#x2F;A  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: ECI-2  </span><br><span class="line"> </span><br><span class="line">Decoded PIN: 1234</span><br></pre></td></tr></table></figure>
<p>##ECI-3 </p>
<p>The ECI-3 PIN block format supports a PIN from 4 to 6 digits in length. A PIN that is longer than 6 digits is truncated on the right.</p>
<p>####CALCULATION STEPS:</p>
<p>#####1.  Prepare a PIN – L – is PIN length, P is PIN digit, 0 is padding character<br>    for PIN shorter than 6 digits, R is random value</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>L</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/0</td>
<td>P/0</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
</tr>
</tbody></table>
<p>Where:</p>
<ul>
<li><p>  L is the length of the PIN, which is a 4-bit value from X’4′ to X’6′.</p>
</li>
<li><p>P – is a PIN digit, which is a 4-bit value from X’0′ to X’9′. The values of<br>  the PIN digits are independent.</p>
</li>
<li><p>0 – is a filling character for PIN’s shorter than 6 digits, so 4 digit PIN<br>  will be extended to 6 digits (1234 -&gt; 123400).</p>
</li>
<li><p>R is a random pad value, which is a value from X’0′ to X’F’. This format<br>  contains 9 random pad values that can have different values.</p>
</li>
</ul>
<p>####EXAMPLE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block encrypt operation finished  </span><br><span class="line">  </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PIN: 1234  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: ECI-3  </span><br><span class="line">  </span><br><span class="line">Clear PIN block:41234E07180DD697</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block decode operation finished  </span><br><span class="line">  </span><br><span class="line">PIN block: 41234E07180DD697  </span><br><span class="line">PAN: N&#x2F;A  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: ECI-3  </span><br><span class="line">  </span><br><span class="line">Decoded PIN: 1234</span><br></pre></td></tr></table></figure>
<p>##ECI-4 </p>
<p>Same as ISO-1.</p>
<p>##IBM 3621</p>
<p>The 3621 PIN block format supports a PIN from 1 to 12 digits in length. A PIN that is longer than 12 digits is truncated on the right.</p>
<p>####CALCULATION STEPS:</p>
<p>#####1.  Prepare a PIN – S1,S2,S3,S4 form a 2-byte sequence number that 3621 (or the originating terminal or node) assigns. P is PIN digit, X is defined padding value</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>S1</td>
<td>S2</td>
<td>S3</td>
<td>S4</td>
<td>P</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
</tr>
</tbody></table>
<p>Where:</p>
<ul>
<li><p>S1 S2 S3 S4 – Forms a 2-byte sequence number that the 3621 (or the<br>  originating terminal or node) assigns. A 3621 assigns the sequence number in<br>  ascending order, starting with X’0000′.</p>
</li>
<li><p>P – is a PIN digit, which is a 4-bit value from X’0′ to X’9′. The values of<br>  the PIN digits are independent.</p>
</li>
<li><p>X – is A pad value has a 4-bit value from X’0′ to X’F’ and must be different<br>  from any PIN digit. The number of pad values for this format are in the<br>  range from 0 to 11, and all the pad values must have the same value.</p>
</li>
</ul>
<p>####EXAMPLE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block encrypt operation finished  </span><br><span class="line">  </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PIN: 1234  </span><br><span class="line">PAD: 5  </span><br><span class="line">Format: IBM 3621  </span><br><span class="line">  </span><br><span class="line">Clear PIN block:0000123455555555</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block decode operation finished  </span><br><span class="line">  </span><br><span class="line">PIN block: 0000123455555555  </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: IBM 3621  </span><br><span class="line">  </span><br><span class="line">Decoded PIN: 1234</span><br></pre></td></tr></table></figure>
<p>##IBM 3624</p>
<p>The 3624 PIN block format supports a PIN from 1 to 16 digits in length. A PIN that is longer than 16 digits is truncated on the right.</p>
<p>####CALCULATION STEPS:</p>
<p>#####1.  Prepare a PIN – P is PIN digit, X is defined padding value</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>P</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
<td>P/X</td>
</tr>
</tbody></table>
<p>Where:</p>
<ul>
<li><p>P – is a PIN digit, which is a 4-bit value from X’0′ to X’9′. The values of<br>  the PIN digits are independent.</p>
</li>
<li><p>X – is A pad value has a 4-bit value from X’0′ to X’F’ and must be different<br>  from any PIN digit. The number of pad values for this format are in the<br>  range from 0 to 15, and all the pad values must have the same value.</p>
</li>
</ul>
<p>####EXAMPLE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block encrypt operation finished  </span><br><span class="line">  </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PIN: 1234  </span><br><span class="line">PAD: 5  </span><br><span class="line">Format: IBM 3624  </span><br><span class="line">  </span><br><span class="line">Clear PIN block:1234555555555555</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block decode operation finished  </span><br><span class="line">  </span><br><span class="line">PIN block: 1234555555555555  </span><br><span class="line">PAN: N&#x2F;A  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: IBM 3624  </span><br><span class="line">  </span><br><span class="line">Decoded PIN: 1234</span><br></pre></td></tr></table></figure>
<p>##IBM 4704-EPP (ENCRYPTING PIN PAD)</p>
<p>The 4704 encrypting PIN Pad PIN block format supports a PIN from 1 to 13 digits in length. A PIN that is longer than 13 digits is truncated on the right.</p>
<p>####CALCULATION STEPS:</p>
<p>#####1.  Prepare a PIN – L – is a PIN length, P is PIN digit, F is padding value ‘F’, S1 S2 is a 1-byte sequence number</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>L</td>
<td>P</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/X</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>S1</td>
<td>S2</td>
</tr>
</tbody></table>
<p>Where:</p>
<ul>
<li><p>  L – is the length of the PIN, which is a 4-bit value from X’4′ to X’D’.</p>
</li>
<li><p>P – is a PIN digit, which is a 4-bit value from X’0′ to X’9′. The values of<br>  the PIN digits are independent.</p>
</li>
<li><p>F – is A pad value has a 4-bit value of X’F’. The number of pad values for<br>  this format are in the range from 0 to 12.</p>
</li>
<li><p>  S1 S2 – is a 1-byte sequence number from X’00’ to X’FF’.</p>
</li>
</ul>
<p>####EXAMPLE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block encrypt operation finished  </span><br><span class="line">  </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PIN: 1234  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: IBM 4704 EPP  </span><br><span class="line">  </span><br><span class="line">Clear PIN block:41234FFFFFFFFF00</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block decode operation finished  </span><br><span class="line">  </span><br><span class="line">PIN block: 41234FFFFFFFFF00  </span><br><span class="line">PAN: N&#x2F;A  </span><br><span class="line">PAD: 5  </span><br><span class="line">Format: IBM 4704 EPP  </span><br><span class="line">  </span><br><span class="line">Decoded PIN: 1234</span><br></pre></td></tr></table></figure>
<p>##IBM 5906 </p>
<p>Same as IBM 3621.</p>
<p>##VISA-1 </p>
<p>Same as ISO-0.</p>
<p>##VISA-2 </p>
<p>The VISA-2 PIN block format supports a PIN from 4 to 6 digits in length. A PIN that is longer than 6 digits is truncated on the right.</p>
<p>####CALCULATION STEPS:</p>
<p>#####1.  Prepare a PIN – L – is PIN length, P is PIN digit, 0 is padding character<br>    for PIN shorter than 6 digits, D is decimal value</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>L</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/0</td>
<td>P/0</td>
<td>D</td>
<td>D</td>
<td>D</td>
<td>D</td>
<td>D</td>
<td>D</td>
<td>D</td>
<td>D</td>
<td>D</td>
</tr>
</tbody></table>
<p>Where:</p>
<ul>
<li><p>  L is the length of the PIN, which is a 4-bit value from X’4′ to X’6′.</p>
</li>
<li><p>P – is a PIN digit, which is a 4-bit value from X’0′ to X’9′. The values of<br>  the PIN digits are independent.</p>
</li>
<li><p>0 – is a filling character for PIN’s shorter than 6 digits, so 4 digit PIN<br>  will be extended to 6 digits (1234 -&gt; 123400).</p>
</li>
<li><p>D is a decimal pad value, which is a 4-bit value from X’0′ to X’9′. All nine<br>  pad values must have the same value.</p>
</li>
</ul>
<p>####EXAMPLE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block encrypt operation finished  </span><br><span class="line">  </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PIN: 1234  </span><br><span class="line">PAD: 5  </span><br><span class="line">Format: VISA-2  </span><br><span class="line">  </span><br><span class="line">Clear PIN block:4123400555555555</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block decode operation finished  </span><br><span class="line">  </span><br><span class="line">PIN block: 4123400555555555  </span><br><span class="line">PAN: N&#x2F;A  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: VISA-2  </span><br><span class="line">  </span><br><span class="line">Decoded PIN: 1234</span><br></pre></td></tr></table></figure>
<p>##VISA-3 </p>
<p>The VISA-3 PIN block format supports a PIN from 4 to 12 digits in length. A PIN that is longer than 12 digits is truncated on the right.</p>
<p>####CALCULATION STEPS:</p>
<p>#####1.  Prepare a PIN – P is PIN digit, F is PIN delimiter, X is a pad value</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/F</td>
<td>P/F/X</td>
<td>P/F/X</td>
<td>P/F/X</td>
<td>P/F/X</td>
<td>P/F/X</td>
<td>P/F/X</td>
<td>P/F/X</td>
<td>F/X</td>
<td>X</td>
<td>X</td>
<td>X</td>
</tr>
</tbody></table>
<p>Where:</p>
<ul>
<li><p>P – is a PIN digit, which is a 4-bit value from X’0′ to X’9′. The values of<br>  the PIN digits are independent.</p>
</li>
<li><p>F – is a a PIN digit or a delimiter X’F’. If the preceding digit is the last<br>  (or rightmost) PIN digit, this digit is the delimiter X’F’.</p>
</li>
<li><p>X is a pad value, which is a 4-bit value from X’0′ to X’F’. All the pad<br>  values must have the same value.</p>
</li>
</ul>
<p>####EXAMPLE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block encrypt operation finished  </span><br><span class="line">  </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PIN: 1234  </span><br><span class="line">PAD: 5  </span><br><span class="line">Format: VISA-3  </span><br><span class="line">  </span><br><span class="line">Clear PIN block:1234F55555555555</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block decode operation finished  </span><br><span class="line">  </span><br><span class="line">PIN block: 1234F55555555555  </span><br><span class="line">PAN: N&#x2F;A  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: VISA-3  </span><br><span class="line">  </span><br><span class="line">Decoded PIN: 1234</span><br></pre></td></tr></table></figure>
<p>##VISA-4 </p>
<p>The VISA-4 PIN block format supports a PIN from 4 to 12 digits in length. A PIN that is longer than 12 digits is truncated on the right.</p>
<p>####CALCULATION STEPS:</p>
<p>#####1.  Prepare a PIN – 0 – is the value X’0′, L is length of the PIN, P is PIN digit, F – is the value X’F’ for the pad value, PAN is twelve 4-bit digits representing the leftmost 12 digits of the primary account number (excluding the check digit).</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>L</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>F</td>
<td>F</td>
</tr>
</tbody></table>
<p>#####2.  Prepare PAN – take 12 leftmost digits of the primary account number (excluding the check digit)</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
</tr>
</tbody></table>
<p>#####3.  XOR both values</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>L</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>P/F</td>
<td>F</td>
<td>F</td>
</tr>
<tr>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
<td>XOR</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
<td>PAN</td>
</tr>
</tbody></table>
<p>Where:</p>
<ul>
<li><p>  0 is the value X’0′</p>
</li>
<li><p>  L – is a PIN length</p>
</li>
<li><p>P is a PIN digit, which is a 4-bit value from X’0′ to X’9′. The values of<br>  the PIN digits are independent.</p>
</li>
<li><p>F – is a pad value of X’F’. The number of PAD digits X’F’ in the<br>  intermediate PIN block (IPB) is in the range from 2 to 10.</p>
</li>
<li><p>PAN – is twelve 4-bit digits representing the leftmost 12 digits of the<br>  primary account number (excluding the check digit). Each PAN digit has a<br>  value from X’0′ to X’9′.</p>
</li>
</ul>
<p>####EXAMPLE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block encrypt operation finished  </span><br><span class="line">  </span><br><span class="line">PAN: 43219876543210987  </span><br><span class="line">PIN: 1234  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: VISA-4  </span><br><span class="line">  </span><br><span class="line">Clear PIN block:041277DE6789ABCD</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PIN blocks: PIN block decode operation finished  </span><br><span class="line">  </span><br><span class="line">PIN block: 041277DE6789ABCD  </span><br><span class="line">PAN: N&#x2F;A  </span><br><span class="line">PAD: N&#x2F;A  </span><br><span class="line">Format: VISA-4  </span><br><span class="line">  </span><br><span class="line">Decoded PIN: 1234</span><br></pre></td></tr></table></figure>
<p>##AS2805 FORMAT 1</p>
<p>The AS2805 Format 1 PIN block format is similar to an ISO-1 PIN block format. The PIN block format supports a PIN from 4 to 12 digits in length.</p>
<p>####CALCULATION STEPS:</p>
<p>#####1.  Prepare a PIN – L is length of the PIN, P is PIN digit, R is random value</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>L</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>R</td>
<td>R</td>
</tr>
</tbody></table>
<p>Where:</p>
<ul>
<li><p>  L – is the length of the PIN, which is a 4-bit value from X’4′ to X’C’.</p>
</li>
<li><p>  R – is a random digit, which is a value from X’0′ to X’F’.</p>
</li>
</ul>
<p>##AS2805 FORMAT 8 (FORMAT 46) </p>
<p>The AS2805 Format 8 PIN block (format 46) is similar to an Format 1 PIN block format. The PIN block format supports zero length PIN Block.</p>
<p>####CALCULATION STEPS:</p>
<p>#####1.  Prepare a PIN – L is length of the PIN, P is PIN digit, R is random value</p>
<table>
<thead>
<tr>
<th><strong>1</strong></th>
<th><strong>2</strong></th>
<th><strong>3</strong></th>
<th><strong>4</strong></th>
<th><strong>5</strong></th>
<th><strong>6</strong></th>
<th><strong>7</strong></th>
<th><strong>8</strong></th>
<th><strong>9</strong></th>
<th><strong>10</strong></th>
<th><strong>11</strong></th>
<th><strong>12</strong></th>
<th><strong>13</strong></th>
<th><strong>14</strong></th>
<th><strong>15</strong></th>
<th><strong>16</strong></th>
</tr>
</thead>
<tbody><tr>
<td>C</td>
<td>L</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>P/R</td>
<td>F</td>
<td>F</td>
</tr>
<tr>
<td>8</td>
<td>0</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>R</td>
<td>F</td>
<td>F</td>
</tr>
</tbody></table>
<p>Where:</p>
<ul>
<li><p>C – Control field, if is X’0′, then the PIN block is processed as a standard<br>  format 01 PIN block.</p>
</li>
<li><p>L – is the length of the PIN, which is a 4-bit X’0′ or value from X’4′ to<br>  X’C’. If it is X’0′ then the PIN block is a Zero PIN block. No checking of<br>  the PIN block is required in this case.</p>
</li>
<li><p>  R – is a random digit, which is a value from X’0′ to X’F’.</p>
</li>
<li><p>  F – the X’F’ character.</p>
</li>
</ul>

    </div>

    
        <hr class="fhr">
        <div id="vcomments"></div>
    
</div>
    <div class="footer" id="footer">
    <p><h4>版权所有 © 2020 | 作者: Victor | 主题 By <a class="theme-author" target="_blank" rel="noopener" href="https://github.com/Xunzhuo/hexo-theme-coder" style="font-size:14px; color: #969696">Coder</a></h4>
    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <span id="busuanzi_container_site_pv">本站浏览总访问量: <span id="busuanzi_value_site_pv"></span></span>
        <span class="post-meta-divider">|</span>
        <span id="busuanzi_container_site_uv">本站访问人数: <span id="busuanzi_value_site_uv"></span></span>
    
    <label class="el-switch el-switch-blue el-switch-sm" style="vertical-align: sub;">
        <input type="checkbox" name="switch" id="update_style">
        <span class="el-switch-style"></span>
    </label>

    <!--         <script type="text/javascript">
    var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
    document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
    </script> -->
</p>
</div>

<input type="hidden" id="web_style" value="light">
<input type="hidden" id="valine_appid" value="7BhrEyumUe2nIefifk8Sv66q-gzGzoHsz">
<input type="hidden" id="valine_appKey" value="nrqy4fXfuHqeYbH4VYOkNDY4">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
color: #698fca;
}
.v .vlist .vcard .vhead .vsys {
color: #3a3e4a;
}
.v .vlist .vcard .vh .vmeta .vat {
color: #638fd5;
}
.v .vlist .vcard .vhead .vnick {
color: #6ba1ff;
}
.v a {
color: #8696b1;
}
.v .vlist .vcard .vhead .vnick:hover {
color: #669bfc;
}
</style>
    <script type="text/javascript" color="173,174,173" opacity='1' zIndex="-2" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
</body>
</html>
